场景输入

医生在系统里输入一句话：

“评估 ICU 患者感染风险并给出下一步策略（adm_id=A2026-001928）”

0) 预处理与权限（M1）

目的：合规 + 防止越权 + 脱敏策略确定

校验 user_id=U1023 是否 ICU 医生、是否有权限读取该 adm_id

若包含 PII（姓名/身份证/手机号），脱敏后再进入后续链路

记录审计：谁在什么时候请求了什么病人数据

输出：allowed=true + trace_id

1) Agent 拆解任务（M6）

Agent 将一句话拆成可执行计划（plan）：

拉取患者当前感染相关关键事实（结构化）

判断感染/脓毒症风险等级（规则/评分）

检索指南/院内制度：48–72h 无效处理、培养要求、耐药风险

生成分层策略（必须做/建议做/可选），并绑定证据与数据

生成病程记录草稿（SOAP），方便写回系统

2) 拉结构化事实（M5：Tool Calling → SQL/API）

调用工具：query_sql(adm_id=A2026-001928) 返回（示例）：

抗生素：PIPTA 已用 52h

体温：最高 39.2℃

SpO2：最低 88%

CRP：156 mg/L

PCT：0.9 → 2.1（上升）

血培养：已采集，未回报

影像：报告提示感染可能（若有 pacs_report）

Agent 做一个“临床摘要”

“48–72h 治疗反应差 + 炎症指标上升 + 氧合下降” → 风险升高

3) 风险等级判断（可选工具：规则/评分）

（生产版常见做法：不用 LLM 做评分，用规则/模型做）

例如跑一个轻量规则：

若满足：发热持续 + PCT上升 + 氧合下降 + 抗菌 48h 无效 → 高风险

若同时伴 MAP 下降/乳酸升高 → 升级为“疑似脓毒症需紧急处理”

输出（示例）：

感染风险：高

“抗菌治疗无效可能性”：高

需优先处理：病原学复核 / 耐药风险 / 源控制

4) RAG++ 检索证据（M4）

目标：给“下一步策略”提供可引用依据
检索内容包括：

指南：抗菌药 48–72h 无效后的处理流程

ICU 院内制度：培养/会诊/用药分级规则

药品说明书：剂量、肾功能调整、注意事项（可选）

返回 snippets + citations（示例）：

“48–72h 无效需复核病原学并调整方案”
引用：G-ABX-2025-08 3.2.1

“ICU 重症感染需评估耐药风险并尽快获取培养结果”
引用：ICU-POLICY-2025-10 2.1

5) 生成“下一步策略”（Agent 产出）

Agent 输出分层建议（更贴近医生使用习惯）：

✅ 必须做（Today）

立即复核病原学：确认血培养/痰培养是否合格、是否需要补采

依据：48–72h 无效处理章节（引用）

评估耐药风险并调整覆盖范围（由临床+药师确认）

依据：ICU 耐药风险制度（引用）

数据依据：PCT上升 + SpO2下降 + 52h 无改善

复核感染源 / 源控制（导管、肺部、腹腔等）

数据依据：持续高热 + 指标升高

👍 建议做（Next 6–12h）

等培养回报前：按风险决定是否需要加用覆盖（例如 MRSA/真菌风险评估）

如果出现低血压/乳酸升高等：走脓毒症 bundle（补液/升压/复查乳酸）

可选（视情况）

复查影像或床旁超声评估感染源

会诊：感染科/药学部

6) 生成“病程记录草稿”（可写回系统）

用 SOAP 模板自动填入（示例）：

S：昨夜发热 39.2℃，痰多

O：PCT 0.9→2.1，CRP 156，SpO2 最低 88%，PIPTA 52h

A：抗菌治疗反应差，感染风险高，需复核病原学与耐药风险

P：补采培养/评估覆盖/源控制/必要时 sepsis bundle

最终草稿写回：artifact_ref = emr_draft:N-REQ-001

7) 审计与可追溯（贯穿全流程）

系统记录：

用了哪些 SQL（SQL_021）

引用了哪些文档章节（doc_id/section/span）

做了哪些工具调用

最终建议的证据链

这就是中国企业/医疗落地最关键的“可控、可追溯、可审计”。
