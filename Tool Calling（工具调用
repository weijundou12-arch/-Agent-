ä½ è¦åšçš„ä¸æ˜¯â€œè®©æ¨¡å‹ä¼šè°ƒç”¨å·¥å…·â€ï¼Œè€Œæ˜¯ğŸ‘‡
1ï¸âƒ£ è®¾è®¡ å·¥å…·åè®®ï¼ˆTool Schemaï¼‰
{
  "name": "query_sql",
  "description": "Query read-only clinical database",
  "parameters": {
    "type": "object",
    "properties": {
      "sql_id": { "type": "string" },
      "params": { "type": "object" }
    },
    "required": ["sql_id"]
  }
}

2ï¸âƒ£ è®¾è®¡ å·¥å…·ç™½åå•

SQL æ¨¡æ¿ç™½åå•

API endpoint ç™½åå•

ç¦æ­¢ä»»æ„ SQL / ä»»æ„ä»£ç æ‰§è¡Œ

3ï¸âƒ£ å†™ æ ¡éªŒ / æ‹¦æˆª / å®¡è®¡é€»è¾‘

æƒé™æ ¡éªŒ

é£é™©åŠ¨ä½œæ‹¦æˆª

æ—¥å¿—å®¡è®¡ï¼ˆè°ã€ä½•æ—¶ã€ç”¨ä»€ä¹ˆå‚æ•°ï¼‰

4ï¸âƒ£ è®¾è®¡ å¤±è´¥ä¸é‡è¯•ç­–ç•¥

å·¥å…·å¤±è´¥ â†’ æ¢å·¥å…·ï¼Ÿ

å‚æ•°ä¸åˆç† â†’ è®© LLM ä¿®æ­£ï¼Ÿ

è¶…æ—¶ â†’ é™çº§ï¼Ÿ

5ï¸âƒ£ æ§åˆ¶ è‡ªåŠ¨åŒ–è¾¹ç•Œ

åªè¯»ï¼šå…¨è‡ªåŠ¨

å»ºè®®ç”Ÿæˆï¼šè‡ªåŠ¨

å†™ç³»ç»Ÿï¼šå¿…é¡»äººå·¥ç¡®è®¤

ğŸ“Œ è¿™ä¸€æ•´å¥—æ‰å«â€œä¼ä¸šçº§ Tool Callingâ€


åœºæ™¯è¾“å…¥ï¼ˆåŒ»ç”Ÿä¸€å¥è¯ï¼‰

â€œè¯„ä¼° A2026-001928 æ„ŸæŸ“é£é™©ï¼Œå¹¶ç»™å‡ºä¸‹ä¸€æ­¥å»ºè®®ã€‚â€

Step 1ï¼šAgent è§„åˆ’ï¼ˆLLM è‡ªåŠ¨ï¼‰
{
  "plan": [
    "query patient basic info",
    "query antibiotics usage",
    "query lab trends",
    "check guideline",
    "generate recommendation"
  ]
}


ğŸ‘‰ è¿™ä¸€æ­¥æ˜¯è‡ªåŠ¨çš„

Step 2ï¼šLLM ç”Ÿæˆ tool_callï¼ˆè‡ªåŠ¨ï¼Œä½†è¿˜æ²¡æ‰§è¡Œï¼‰
{
  "tool_call": {
    "name": "query_sql",
    "arguments": {
      "sql_id": "SQL_021",
      "params": {
        "adm_id": "A2026-001928"
      }
    }
  }
}


ğŸ‘‰ è¿™ä¸€æ­¥ä¹Ÿæ˜¯è‡ªåŠ¨çš„

Step 3ï¼šç³»ç»Ÿæ ¡éªŒï¼ˆä¸æ˜¯ LLM åšçš„ï¼‰

ä½ ä½œä¸ºå·¥ç¨‹å¸ˆè¦å†™è¿™ä¸€æ­¥ã€‚

æ ¡éªŒå†…å®¹åŒ…æ‹¬ï¼š

â“ è¿™ä¸ªç”¨æˆ·æœ‰æ²¡æœ‰æƒé™æŸ¥è¿™ä¸ªæ‚£è€…ï¼Ÿ

â“ SQL æ˜¯å¦åœ¨ç™½åå•ï¼Ÿ

â“ å‚æ•°æ˜¯å¦åˆæ³•ï¼Ÿ

â“ æ˜¯å¦æ˜¯åªè¯»æ“ä½œï¼Ÿ

if not check_permission(user, "SQL_021"):
    reject("permission denied")

if not validate_params(params):
    reject("invalid params")

if is_write_sql(sql_id):
    require_confirmation()


ğŸ“Œ è¿™ä¸€æ­¥æ˜¯â€œéè‡ªåŠ¨ã€å·¥ç¨‹å¼ºåˆ¶â€çš„

Step 4ï¼šå·¥å…·æ‰§è¡Œï¼ˆè‡ªåŠ¨ï¼‰
result = execute_sql(SQL_021, params)

Step 5ï¼šç»“æœå›ä¼ ç»™ LLMï¼ˆè‡ªåŠ¨ï¼‰
{
  "tool_result": {
    "antibiotic": "PIPTA",
    "hours_used": 52,
    "crp_trend": "up",
    "pct_trend": "up"
  }
}

Step 6ï¼šLLM å†³ç­–ä¸‹ä¸€æ­¥ï¼ˆè‡ªåŠ¨ï¼‰

æ˜¯å¦ç»§ç»­æŸ¥ï¼Ÿ

æ˜¯å¦è¿›å…¥ RAGï¼Ÿ

æ˜¯å¦ç”Ÿæˆå»ºè®®ï¼Ÿ

ğŸ‘‰ LLM å†æ¬¡ç”Ÿæˆä¸‹ä¸€æ­¥ tool_call æˆ– final answer
